% ce-so-one.tex

\documentclass{standalone}
\input{newcommands}
\newcommand{\keyvar}{\mathit{k}}

\usepackage{tikz}
\usetikzlibrary{calc, trees, positioning, arrows, chains, shapes.geometric,
    decorations.pathreplacing, decorations.pathmorphing, shapes,
    matrix, shapes.symbols}

\begin{document}
\begin{tikzpicture}[
  node distance = 1.0cm and 1.5cm,
  every label/.style = {font = \scriptsize},
  so/.style = {->, thick},
  wr/.style = {->, thick},
  ww/.style = {->, thick, dashed},
  rw/.style = {->, thick, dotted},
  txn/.style = {draw, inner sep = 2pt, align = center, anchor = center}]

  \node[txn, label = above left : {$(10, \_)$}] (10-471)
    {$\readevent(\keyvar_{339}, 3)$ \\ \red{$\writeevent(\keyvar_{378}, 7)$} \\ $\writeevent(\keyvar_{521}, 8)$};
  \node[txn, below = of 10-471, label = above left : {$(4, \_)$}] (4-167) {$\writeevent(\keyvar_{339}, 3)$ \\ \red{$\writeevent(\keyvar_{378}, 2)$} \\ $\writeevent(\keyvar_{761}, 5)$};

  \node[txn, above = of 10-471, label = above left: {$(9, 429)$}] (9-429) {\red{$\readevent(\keyvar_{378}, 2)$} \\ $\readevent(\keyvar_{457}, 2)$};
  \node[txn, right = of 9-429, label = above left: {$(1, 43)$}] (1-43) {$\readevent(\keyvar_{521}, 8)$ \\ $\writeevent(\keyvar_{457}, 2)$};

  \path (1-43) edge[wr] node[above]{$\WR(\keyvar_{457})$} (9-429)
	(10-471) edge[wr] node[sloped, below]{$\WR(\keyvar_{521})$} (1-43)
  (10-471.-60) edge[ww, blue, right, very thick] node[] {$\WW(\keyvar_{378})$} (10-471.-60 |- 4-167.north)
	(4-167.120) edge[ww, violet, left, very thick] node[] {$\WW(\keyvar_{378})$} (4-167.120 |- 10-471.south)
	(4-167.20) edge[wr, bend right = 60] node[] {$\WR(\keyvar_{339})$} (10-471.20)
	(9-429) edge[rw, violet, very thick] node {$\RW(\keyvar_{378})$} (10-471);
  \end{tikzpicture}
\end{document}